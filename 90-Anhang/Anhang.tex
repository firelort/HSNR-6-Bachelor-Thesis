\begin{table}
	\centering
	\begin{tabular}{l l}
		Route									 & Methods \\ [0.5ex]
		\hline
		/										 & GET \\
		/associate								 & GET, POST \\
		/associate/<int:associate\_id>			 & DELETE \\
		/auth/flagshop/login					 & POST \\
		/auth/login								 & POST \\
		/auth/refresh							 & POST \\
		/auth/revoke/access						 & DELETE \\
		/auth/revoke/refresh					 & DELETE \\
		/backup									 & GET \\
		/backup/<int:backup\_id>				 & GET \\
		/challenge								 & GET, POST \\
		/challenge/<int:challenge\_id>			 & DELETE, GET, PUT \\
		/challenge/solve						 & GET \\
		/challenge/solve/<int:challenge\_id>	 & DELETE, POST \\
		/client									 & GET, POST \\
		/client/<int:group\_id>					 & DELETE, GET \\
		/flag									 & POST \\
		/flagshop/package						 & GET, POST \\
		/flagshop/package/<int:package\_id>		 & DELETE, PUT \\
		/flagshop/transaction					 & DELETE, GET, POST \\
		/flagshop/user							 & GET, POST \\
		/flagshop/user/<user\_name>				 & DELETE, PUT \\
		/log									 & GET, POST \\
		/log/old								 & GET \\
		/match/control							 & DELETE, POST, PUT \\
		/match/info								 & GET \\
		/match/score							 & GET \\
		/note									 & GET, POST \\
		/note/<int:note\_id>					 & DELETE, GET, PUT \\
		/penalty								 & GET, POST \\
		/penalty/<int:penalty\_id>				 & DELETE, GET, PUT \\
		/scanner								 & DELETE, GET, POST \\
		/scanner/notify							 & POST \\
		/secure									 & GET \\
		/service								 & GET \\
		/service/<int:service\_id>				 & DELETE, GET, PUT \\
		/setting								 & GET, PUT \\
		/user									 & DELETE, GET, POST \\
		/user/<int:user\_id>					 & DELETE, GET, PUT \\
		/user/import							 & POST \\
	\end{tabular}
	\caption{Übersicht über die implementierten Routen}
	\label{table:gis-routes}
\end{table}
\begin{table}
	\centering
	\begin{tabular}{l l c c c c}
		Methode & Route	& Admin & Supervisor & Player  & Flagshop \\ [0.5ex]
		\hline &&&&&\\
		GET		& /									& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		GET		& /associate 						& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST	& /associate						& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		DELETE	& /associate/<int:associate\_id>	& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		POST	& /auth/flagshop/login				& $\chi$ & $\chi$ & $\surd$ & $\chi$ \\
		POST	& /auth/login						& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		POST	& /auth/refresh						& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		DELETE	& /auth/revoke/access				& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		DELETE	& /auth/revoke/refresh				& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		GET		& /backup							& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		GET 	& /backup/<int:backup\_id>			& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		GET		& /challenge						& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		POST	& /challenge						& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /challenge/<int:challenge\_id>	& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		PUT		& /challenge/<int:challenge\_id>	& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /challenge/<int:challenge\_id>	& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /challenge/solve					& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST	& /challenge/solve/<int:challenge\_id>& $\chi$ & $\chi$ & $\surd$ & $\chi$ \\
		DELETE	& /challenge/solve/<int:challenge\_id>& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET 	& /client							& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		POST	& /client							& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		GET 	& /client/<int:group\_id>			& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /client/<int:group\_id>			& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST 	& /flag								& $\chi$ & $\chi$ & $\surd$ & $\chi$ \\
		GET		& /flagshop/package					& $\surd$ & $\surd$ & $\chi$ & $\surd$ \\
		POST	& /flagshop/package					& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		PUT 	&/flagshop/package/<int:package\_id>& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	&/flagshop/package/<int:package\_id>& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /flagshop/transaction				& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST	& /flagshop/transaction				& $\chi$ & $\chi$ & $\chi$ & $\surd$ \\
		DELETE	& /flagshop/transaction				& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /flagshop/user					& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST	& /flagshop/user					& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		PUT		& /flagshop/user/<user\_name>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /flagshop/user/<user\_name>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET 	& /log								& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST 	& /log								& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /log/old							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
	\end{tabular}
\caption{Berechtigungsmatrix der Routen 1/2}
\label{table:gis-permission-1}
\end{table}

\begin{table}
	\centering
	\begin{tabular}{l l c c c c}
		Methode & Route	& Admin & Supervisor & Player  & Flagshop \\ [0.5ex]
		\hline &&&&&\\
		POST	& /match/control					& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		PUT		& /match/control					& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /match/control					& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /match/info						& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		GET		& /match/score						& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		GET		& /note								& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		POST	& /note								& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET 	& /note/<int:note\_id>				& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		PUT 	& /note/<int:note\_id>				& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /note/<int:note\_id>				& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /penalty							& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		POST	& /penalty							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /penalty/<int:penalty\_id>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		PUT		& /penalty/<int:penalty\_id>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /penalty/<int:penalty\_id>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /scanner							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST	& /scanner							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /scanner							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		POST	& /scanner/notify					& $\chi$ & $\chi$ & $\chi$ & $\chi$ \\
		GET 	& /secure							& $\surd$ & $\surd$ & $\surd$ & $\chi$ \\
		GET		& /service							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /service/<int:service\_id>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		PUT		& /service/<int:service\_id>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /service/<int:service\_id>		& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /setting							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		PUT		& /setting							& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /user								& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		POST	& /user								& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		DELETE	& /user								& $\surd$ & $\surd$ & $\surd$ & $\surd$ \\
		GET 	& /user/<int:user\_id>				& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		PUT 	& /user/<int:user\_id>				& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		DELETE	& /user/<int:user\_id>				& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
		GET		& /user/import						& $\surd$ & $\surd$ & $\chi$ & $\chi$ \\
	\end{tabular}
	\caption{Berechtigungsmatrix der Routen 2/2}
	\label{table:gis-permission}
\end{table}


\begin{lstlisting}[frame=single, language=python, caption={Config Vorlage Big Brother}, captionpos=b, label={lst:anhang-bigbrother-config-example}]
class Config(object):
  database = {
    "username": "USERNAME",
    "password": "PASSWORD",
    "database": "DATABASE",
    "host": "HOST",
    "port": 5432
  }
  webserver = {
    "url": "webserver notify url",
    "auth": "Authentication Header"
  }
  operations = {
    "base": {
      "ping_timeout": 4,
      "ssh_timeout": 4
    },
    "sql": {
      "username": "SQL Username",
      "password": "SQL Password"
    },
    "sql_injection": {
      "admin": {
        "username": "ADMIN_SQL_USER",
        "password": "ADMIN_SQL_PASSWORD"
	  },
	  "control": {
	    "flag": "FLAG",
	    "value": "FLAG_VALUE"
	  }
    },
    "htaccess": {
      "username": "HTACCESS_USER",
      "password": "HTACCESS_PASSWORD"
    },
    "bubble": {
      "bubble_port": 12345,
      "bubble_ng_port": 12345
    }
  }
\end{lstlisting}
\begin{lstlisting}[frame=single, language=sql, caption={SQL View Gesamtpunkte}, captionpos=b, label={lst:databas-total-points-sql}]
CREATE VIEW public.total_points AS 
SELECT grp.id, grp.name, 
(COALESCE(cha.total_points, ((0)::smallint)::bigint))::smallint AS challenge_points,
(COALESCE(dis.points, ((0)::smallint)::bigint))::smallint AS discover_points,
(COALESCE(ofe.points, ((0)::smallint)::bigint))::smallint AS offence_points,
(COALESCE(def.points, ((0)::smallint)::bigint))::smallint AS defence_points,
(COALESCE(tmp.service_points, ((0)::smallint)::bigint))::smallint AS service_points,
(COALESCE(fla.points_spend, ((0)::smallint)::bigint))::smallint AS flagsshop_points,
(COALESCE(pen.total_penalty, ((0)::smallint)::bigint))::smallint AS penalty_points,
(((((((COALESCE(cha.total_points, ((0)::smallint)::bigint))::smallint + (COALESCE(dis.points, ((0)::smallint)::bigint))::smallint) + (COALESCE(ofe.points, ((0)::smallint)::bigint))::smallint) - (COALESCE(def.points, ((0)::smallint)::bigint))::smallint) - (COALESCE(tmp.service_points, ((0)::smallint)::bigint))::smallint) - (COALESCE(fla.points_spend, ((0)::smallint)::bigint))::smallint) - (COALESCE(pen.total_penalty, ((0)::smallint)::bigint))::smallint) AS total_points
FROM (((((((groups grp 
LEFT JOIN challenge_points cha ON ((grp.id = cha.group_id)))
LEFT JOIN discover_points dis ON ((grp.id = dis.group_id)))
LEFT JOIN offence_points ofe ON ((grp.id = ofe.group_id)))
LEFT JOIN defence_points def ON ((grp.id = def.group_id)))
LEFT JOIN flagshop_points fla ON ((grp.id = fla.group_id)))
LEFT JOIN penalty_points pen ON ((grp.id = pen.group_id)))
JOIN (SELECT grp_1.id, sum(gsp.service_points) AS service_points
FROM (groups grp_1 LEFT JOIN group_service_points gsp ON ((grp_1.id = gsp.group_id))) 
GROUP BY grp_1.id) tmp ON ((grp.id = tmp.id)));
\end{lstlisting}
\newpage
\begin{lstlisting}[language=Python, frame=single, caption={Big Brother Scanner}, captionpos=b, label={lst:bigbrother-scanner}]
self._host_up.start()
results['host_up'] = self._host_up.result
results['http_up'] = False
for scan_operation in self._scanner_list:
  results[scan_operation.name] = False

for scan_operation in self._scanner_list_http_up:
  results[scan_operation.name] = False
if results['host_up']:
  self._http_up.start()
  results['http_up'] = self._http_up.result
  
  future_list = []
  for scan_operation in self._scanner_list:
    future_list.append(pool.submit(scan_operation.start))
    
  if results['http_up']:
    for scan_operation in self._scanner_list_http_up:
      future_list.append(pool.submit(scan_operation.start))
      
  wait(future_list)
  for scan_operation in self._scanner_list:
    results[scan_operation.name] = scan_operation.result

  if results['http_up']:
    for scan_operation in self._scanner_list_http_up:
      results[scan_operation.name] = scan_operation.result

for key in results:
  if results[key]:
    online_count_add = 1
    else:
  online_count_add = 0

  try:
    self._cursor.execute( f"UPDATE {GROUP_SERVICE_TABLE_NAME} SET online_count =  online_count + {online_count_add}, scan_count =  scan_count + 1, was_online = {results[key]}, last_scan = CURRENT_TIMESTAMP WHERE group_id = {self._id} AND service_id = {self._get_id_of_scan_operation(key)}")
\end{lstlisting}