\begin{table}
	\centering
	\begin{tabular}{l l c c c c}
		Methode & Route	& Admin & Supervisor & Player  & Flagshop \\ [0.5ex]
		\hline &&&&&\\
		GET & /	&  $\surd$ &  $\surd$  &  $\surd$ &  $\surd$ \\
	\end{tabular}
	\caption{Berechtigungsmatrix der Routen}
	\label{table:gis-permission}
\end{table}


\begin{lstlisting}[frame=single, language=python, caption={Config Vorlage Big Brother}, captionpos=b, label={lst:anhang-bigbrother-config-example}]
	class Config(object):
	database = {
		"username": "USERNAME",
		"password": "PASSWORD",
		"database": "DATABASE",
		"host": "HOST",
		"port": 5432
	}
	
	webserver = {
		"url": "webserver notify url",
		"auth": "Authentication Header"
	}
	
	operations = {
		"base": {
			# timeout=1 -> Faster response if client is not reachable, 0 returns unexpected behaviour
			"ping_timeout": 4,
			# timeout=1 -> Faster response if client is not reachable, 0 returns unexpected behaviour
			"ssh_timeout": 4
		},
		"sql": {
			"username": "SQL Username",
			"password": "SQL Password"
		},
		"sql_injection": {
			"admin": {
				"username": "ADMIN_SQL_USER",
				"password": "ADMIN_SQL_PASSWORD"
			},
			"control": {
				"flag": "FLAG",
				"value": "FLAG_VALUE"
			}
		},
		"htaccess": {
			"username": "HTACCESS_USER",
			"password": "HTACCESS_PASSWORD"
		},
		"bubble": {
			"bubble_port": 12345,
			"bubble_ng_port": 12345
		}
	}
\end{lstlisting}

\begin{lstlisting}[frame=single, language=sql, caption={todo}, captionpos=b, label={lst:databas-total-points-sql}]
CREATE VIEW public.total_points AS 

SELECT grp.id, grp.name, 
(COALESCE(cha.total_points, ((0)::smallint)::bigint))::smallint AS challenge_points,
(COALESCE(dis.points, ((0)::smallint)::bigint))::smallint AS discover_points,
(COALESCE(ofe.points, ((0)::smallint)::bigint))::smallint AS offence_points,
(COALESCE(def.points, ((0)::smallint)::bigint))::smallint AS defence_points,
(COALESCE(tmp.service_points, ((0)::smallint)::bigint))::smallint AS service_points,
(COALESCE(fla.points_spend, ((0)::smallint)::bigint))::smallint AS flagsshop_points,
(COALESCE(pen.total_penalty, ((0)::smallint)::bigint))::smallint AS penalty_points,
(((((((COALESCE(cha.total_points, ((0)::smallint)::bigint))::smallint + (COALESCE(dis.points, ((0)::smallint)::bigint))::smallint) + (COALESCE(ofe.points, ((0)::smallint)::bigint))::smallint) - (COALESCE(def.points, ((0)::smallint)::bigint))::smallint) - (COALESCE(tmp.service_points, ((0)::smallint)::bigint))::smallint) - (COALESCE(fla.points_spend, ((0)::smallint)::bigint))::smallint) - (COALESCE(pen.total_penalty, ((0)::smallint)::bigint))::smallint) AS total_points
FROM (((((((groups grp 
LEFT JOIN challenge_points cha ON ((grp.id = cha.group_id)))
LEFT JOIN discover_points dis ON ((grp.id = dis.group_id)))
LEFT JOIN offence_points ofe ON ((grp.id = ofe.group_id)))
LEFT JOIN defence_points def ON ((grp.id = def.group_id)))
LEFT JOIN flagshop_points fla ON ((grp.id = fla.group_id)))
LEFT JOIN penalty_points pen ON ((grp.id = pen.group_id)))
JOIN (SELECT grp_1.id, sum(gsp.service_points) AS service_points
FROM (groups grp_1 LEFT JOIN group_service_points gsp ON ((grp_1.id = gsp.group_id))) 
GROUP BY grp_1.id) tmp ON ((grp.id = tmp.id)));
\end{lstlisting}

\begin{lstlisting}[language=Python, frame=single, caption={Big Brother Scanner}, captionpos=b, label={lst:bigbrother-scanner}]
self._host_up.start()

results['host_up'] = self._host_up.result
results['http_up'] = False
for scan_operation in self._scanner_list:
  results[scan_operation.name] = False

for scan_operation in self._scanner_list_http_up:
  results[scan_operation.name] = False

if results['host_up']:
  self._http_up.start()
  results['http_up'] = self._http_up.result
  
  future_list = []
  for scan_operation in self._scanner_list:
    future_list.append(pool.submit(scan_operation.start))
    
  if results['http_up']:
    for scan_operation in self._scanner_list_http_up:
      future_list.append(pool.submit(scan_operation.start))

  wait(future_list)

  for scan_operation in self._scanner_list:
    results[scan_operation.name] = scan_operation.result

  if results['http_up']:
    for scan_operation in self._scanner_list_http_up:
      results[scan_operation.name] = scan_operation.result

for key in results:
  if results[key]:
    online_count_add = 1
    else:
  online_count_add = 0

  try:
    self._cursor.execute( f"UPDATE {GROUP_SERVICE_TABLE_NAME} SET online_count =  online_count + {online_count_add}, scan_count =  scan_count + 1, was_online = {results[key]}, last_scan = CURRENT_TIMESTAMP WHERE group_id = {self._id} AND service_id = {self._get_id_of_scan_operation(key)}")
\end{lstlisting}